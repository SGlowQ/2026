<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026é«˜è€ƒå€’è®¡æ—¶Ã—ç¥ˆæ„¿ç‚¹å</title>
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <!-- æ–°å¢äº”æ˜ŸéŸ³é¢‘ -->
    <audio id="fiveStarSound" preload="auto">
        <source src="Genshin Impact Wish Roll 5.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
    </audio>
    <!-- æ–°å¢å››æ˜ŸéŸ³é¢‘ -->
    <audio id="fourStarSound" preload="auto">
        <source src="Genshin Impact Wish Roll 4.mp3" type="audio/mpeg"> <!-- å››æ˜ŸéŸ³é¢‘æ–‡ä»¶ -->
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
    </audio>
    <!-- æ–°å¢ä¸‰æ˜ŸéŸ³é¢‘ -->
    <audio id="threeStarSound" preload="auto">
        <source src="Genshin Impact Wish Roll 3.mp3" type="audio/mpeg"> <!-- ä¸‰æ˜ŸéŸ³é¢‘æ–‡ä»¶ -->
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
    </audio>
    <!-- å¼€å±é®ç½© -->
    <div id="splash-mask" style="
        position:fixed;
        left:0;top:0;
        width:100vw;height:100vh;
        background:rgb(0, 0, 0);
        color:#fff;
        z-index:9999;
        display:flex;
        align-items:center;
        justify-content:center;
        font-size:2.2rem;
        cursor:pointer;
        flex-direction:column;
        transition:opacity 0.5s;
    ">
        <div style="font-size:5rem;">ğŸŒŸ 2026é«˜è€ƒå€’è®¡æ—¶ Ã— ç¥ˆæ„¿ç‚¹å ğŸŒŸ</div>
        <div style="margin-top:2rem;font-size:1.2rem;">ç‚¹å‡»å±å¹•è¿›å…¥</div>
    </div>
    <!-- è§†é¢‘å®¹å™¨ï¼Œåˆå§‹ä¸ºç©º -->
    <div id="bg-video" style="
    position:fixed;
    left:0;top:0;
    width:100vw;height:100vh;
    z-index:-2;
    background:#000;   
    overflow:hidden;
"></div>
    <script>
        const bvidList = [
            "BV1CX4y1t7gA",/*éª„å‚²çš„å°‘å¹´*/
            // "BV1uw5Jz9EmK",/*æ™´å¤©*/
            // "BV1Zd4y1A7yc",/*å¦ˆå¦ˆçš„è¯*/
            // "BV1ix411974d",/*ç¨»é¦™*/
            // "BV1Bv411E7uY",/*ä¾§è„¸*/
            // "BV1ESYBzuEUh",/*æ½®æ±*/
            // "BV1hW411v7GC",/*ç­‰ä½ ä¸‹è¯¾*/
            // "BV1aV4y1Y7Yb",/*ç¬¬57æ¬¡å–æ¶ˆå‘é€*/
            // "BV1A7411K7bB",/*å†¬çœ */
            // "BV1XJ4m1W7Ch",/*å¤šè°¢ä½ æ‹…å¿ƒ*/
            // "BV1f5411F7Yv",/*å •*/
            // "BV19T411k7Tw",/*æµ®å…‰*/
            // "BV1E7411k7Qy",/*æº¯*/
            // "BV1U24y1y7XG",/*é¾™å·é£*/
            // "BV1UY4y1Y7LR",/*æ˜å¤©ï¼Œä½ å¥½*/
            // "BV1u8yKYXEkj",/*ç½—ç”Ÿé—¨*/
            // "BV1echreGEFM",/*æš®è‰²å›å“*/
            // "BV1h5411F7sK",/*ä½ ä»æœªç¦»å»*/
        ];

        // éšæœºé€‰ä¸€ä¸ª bvid
        const randomBvid = bvidList[Math.floor(Math.random() * bvidList.length)];

        // ç”¨æˆ·ç‚¹å‡»åæ’å…¥éšæœºè§†é¢‘
        document.getElementById('splash-mask').onclick = function () {
            this.style.opacity = '0';
            setTimeout(() => {
                this.style.display = 'none';
                document.getElementById('bg-video').innerHTML = `
            <iframe 
                src="https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=${randomBvid}&autoplay=1&as_wide=1&t=0&danmaku=0"
                frameborder="no"
                scrolling="no"
                allowfullscreen
                allow="autoplay"
                style="width:100vw;height:100vh;position:fixed;left:0;top:0;z-index:-2;pointer-events:none;filter:brightness(0.5);background:transparent;">
            </iframe>
        `;
            }, 500);
        };
    </script>
    <style>
        /* æ ·å¼ä¿æŒä¸å˜ï¼Œä¸åŸå§‹ä»£ç ç›¸åŒ */
        ::-webkit-scrollbar {
            display: none;
        }

        /* Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Firefox */
        input[type="number"] {
            -moz-appearance: textfield;
            -webkit-appearance: none;
            appearance: none;
        }

        @font-face {
            font-family: 'Elements';
            src: url('genshin-icon.ttf') format('truetype');
        }

        :root {
            --pyro: #ff6752;
            /* ç« */
            --hydro: #4fc3f7;
            /* æ°´ */
            --anemo: #73e6c2;
            /* é£ */
            --electro: #b388ff;
            /* é›· */
            --dendro: #a0d84f;
            /* è‰ */
            --cryo: #99d9ea;
            /* å†° */
            --geo: #ffcc29;
            /* å²© */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: sans-serif;
            -webkit-user-select: none;
            /* Chrome, Safari, Opera */
            -moz-user-select: none;
            /* Firefox */
            -ms-user-select: none;
            /* Internet Explorer/Edge */
            user-select: none;
            /* Non-prefixed version, currently supported by Chrome, Opera and Firefox */
        }

        body {
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 2;
        }

        header {
            text-align: center;
            animation: fadeIn 5s ease-out;
        }

        h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(220.55deg, #00E0EE 0%, #AD00FE 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #bbdefb;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .countdown-container {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin: 4rem 0;
            flex-wrap: wrap;
        }

        .countdown-box {
            background: rgba(25, 118, 210, 0.15);
            backdrop-filter: blur(5px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem 1.5rem;
            min-width: 150px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .countdown-value {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(to bottom, #e0f7fa, #80deea);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .countdown-label {
            font-size: 1.1rem;
            color: #e3f2fd;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        #daysBox {
            height: 15rem;
            background: rgba(0, 0, 0, 0);
            backdrop-filter: none;
            border: none;
            box-shadow: none;
        }

        #daysBox .countdown-value {
            font-size: 10rem;
            opacity: 0.5;
        }

        .motivation-container {
            background: rgba(21, 101, 192, 0.15);
            backdrop-filter: blur(5px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            margin: 4rem 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }

        .motivation-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 2rem;
        }

        .motivation-header h2 {
            font-size: 2.2rem;
            color: #bbdefb;
        }

        .motivation-header i {
            font-size: 2rem;
            color: #4fc3f7;
        }

        #hitokoto {
            background: linear-gradient(90deg, #da75ff, #6a82fb);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.4rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            transition: opacity 0.5s ease;
        }

        .scrolling-names {
            display: flex;
            animation: scroll 180s linear infinite;
            white-space: nowrap;
            width: fit-content;
            will-change: transform;
        }

        .name-item {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 180px;
            height: 80px;
            background: rgba(41, 182, 246, 0.2);
            border-radius: 12px;
            margin: 0 10px;
            font-size: 1.4rem;
            font-weight: 500;
            padding: 0 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .name-item::after {
            content: "åŠ æ²¹!";
            position: absolute;
            bottom: 5px;
            right: 10px;
            font-size: 0.9rem;
            color: #00ff00;
            font-weight: 400;
        }

        .name-item:hover {
            transform: translateY(-5px);
            background: rgba(41, 182, 246, 0.3);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .name-item:hover::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(79, 172, 254, 0.3), rgba(0, 242, 254, 0.3));
            z-index: -1;
            border-radius: 12px;
        }

        .motivation-text {
            font-size: 1.8rem;
            text-align: center;
            margin: 3rem auto;
            width: auto;
            padding: 1.5rem;
            backdrop-filter: blur(5px);
            background: rgba(25, 118, 210, 0.2);
            border-radius: 16px;
        }

        footer {
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
            color: #90caf9;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }


        @keyframes scroll {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-50%);
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .countdown-box {
                min-width: 120px;
                padding: 1.5rem 1rem;
            }

            .countdown-value {
                font-size: 2.5rem;
            }

            .name-item {
                min-width: 150px;
                height: 70px;
                font-size: 1.2rem;
            }
        }

        @media (max-width: 480px) {
            .countdown-box {
                min-width: 80px;
                padding: 1rem 0.5rem;
            }

            .countdown-value {
                font-size: 2rem;
            }

            .countdown-label {
                font-size: 0.9rem;
            }

            .name-item {
                min-width: 130px;
                height: 60px;
                font-size: 1.1rem;
            }
        }

        #lotteryBtn {
            width: 130px;
            height: 60px;
            font-size: 1.1rem;
            border-radius: 8px;
            color: white;
            border: none;
            cursor: pointer;
            background-image: url('https://fastcdn.mihoyo.com/content-v2/hk4e/159347/cbfdfee5c271ee8fa07a121b1809982f_4021873944712892023.jpg');
            background-size: cover;
            background-position: center;
            transition: all 1s ease;
        }

        #lotteryBtn:hover {
            background: #007bff;
        }

        /* æ–°å¢å†å²è®°å½•æ ·å¼ */
        .history-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            z-index: 3;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .history-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.3);
        }

        .history-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 5;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .history-content {
            /*background: linear-gradient(135deg, #1a237e, #283593);*/
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow: hidden;
            padding: 30px;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: auto;
        }

        .history-title {
            text-align: center;
            margin-bottom: 25px;
            color: #ffffff;
            font-size: 2rem;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .history-slider {
            overflow: hidden;
            position: relative;
        }

        .history-slides {
            display: flex;
            transition: transform 0.5s ease;
        }

        .history-group {
            min-width: 100%;
            padding: 0 10px;
            box-sizing: border-box;
        }

        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .group-title {
            font-size: 1.2rem;
            color: #bbdefb;
        }

        .group-date {
            font-size: 0.9rem;
            color: #90caf9;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin: 8px 0;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }


        .item-name {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .item-rarity {
            font-weight: bold;
        }

        .five-star {
            color: #ffeb3b;
            text-shadow: 0 0 5px rgba(255, 235, 59, 0.5);
        }

        .four-star {
            color: #bb86fc;
            text-shadow: 0 0 5px rgba(187, 134, 252, 0.5);
        }

        .three-star {
            color: #03a9f4;
            text-shadow: 0 0 5px rgba(3, 169, 244, 0.5);
        }

        .item-time {
            font-size: 0.85rem;
            color: #90caf9;
        }

        .slider-controls {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 15px;
        }

        .slider-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .slider-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .slider-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .slider-dots {
            display: flex;
            justify-content: center;
            margin-top: 15px;
            gap: 8px;
        }

        .slider-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .slider-dot.active {
            background: #4fc3f7;
            transform: scale(1.2);
        }

        .no-history {
            text-align: center;
            padding: 30px;
            color: #90caf9;
            font-style: italic;
        }

        /* é—®å·ä¸ç®€ä»‹æŒ‰é’®æ ·å¼ */
        .announcement-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .announcement-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* é—®å·ä¸è¯´æ˜å¼¹çª—æ ·å¼ */
        .announcement-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 5;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .announcement-content {
            /*background: linear-gradient(135deg, #1a237e, #283593);*/
            width: 90%;
            max-width: 60rem;
            max-height: 80vh;
            overflow: hidden;
            padding: 30px;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .announcement-title {
            text-align: center;
            margin-bottom: 25px;
            color: #ffffff;
            font-size: 2rem;
        }

        .announcement-scroll {
            overflow-y: auto;
            max-height: 60vh;
            padding-right: 10px;
        }

        .announcement-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .announcement-item h3 {
            color: #4fc3f7;
            margin-bottom: 10px;
        }

        .announcement-item p {
            color: #e3f2fd;
            line-height: 1.5;
            margin-bottom: 5px;
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        .announcement-scroll::-webkit-scrollbar {
            width: 5px;
        }

        .announcement-scroll::-webkit-scrollbar-thumb {
            background: #4fc3f7;
            border-radius: 10px;
        }

        /* äº”æ˜Ÿç‰¹æ•ˆå®¹å™¨ - åˆå§‹çŠ¶æ€å…¨å±é»‘è‰² */
        .wish-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 6;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease-out;
        }

        /* æ¿€æ´»çŠ¶æ€ */
        .wish-effect.active {
            opacity: 1;
            pointer-events: all;
        }


        /* é‡‘å…‰è¿¸å‘æ•ˆæœ */
        .golden-light {
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            opacity: 0;
            transform: scale(0);
            filter: blur(5px);
        }

        /* é‡‘å…‰æ”¾å¤§åŠ¨ç”» */
        @keyframes goldenLightAnimation {
            0% {
                opacity: 0;
                transform: scale(5)translateZ(0);
            }

            40% {
                opacity: 1;
                transform: scale(10)translateZ(0);
            }

            70% {
                opacity: 1;
                transform: scale(5)translateZ(0);
            }

            100% {
                opacity: 0;
                transform: scale(50)translateZ(0);
            }
        }


        /* è§’è‰²åç§°å±•ç¤º */
        .character-name {
            position: relative;
            text-align: center;
            opacity: 0;
            transform: translateY(50px) scale(3);
            /* åˆå§‹çŠ¶æ€ï¼šæ”¾å¤§3å€ */
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 7;
        }

        .character-name.revealed {
            opacity: 1;
            transform: translateY(0) scale(1);
            /* æœ€ç»ˆçŠ¶æ€ï¼šæ­£å¸¸å¤§å° */
        }

        /* åŸºç¡€åå­—æ–‡æœ¬æ ·å¼ */
        .name-text {
            font-size: 10rem;
            font-weight: bold;
            color: #fff;
        }

        /* äº”æ˜Ÿç‰¹æ•ˆæ ·å¼ */
        .five-star-effect {
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8),
                0 0 40px rgba(255, 215, 0, 0.6),
                0 0 60px rgba(255, 215, 0, 0.4);
            background: #ffd700;
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* å››æ˜Ÿç‰¹æ•ˆæ ·å¼ */
        .four-star-effect {
            text-shadow: 0 0 20px rgba(162, 89, 255, 0.8),
                0 0 40px rgba(162, 89, 255, 0.6),
                0 0 60px rgba(162, 89, 255, 0.4);
            background: #A259FF;
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ä¸‰æ˜Ÿç‰¹æ•ˆæ ·å¼ */
        .three-star-effect {
            text-shadow: 0 0 20px rgba(0, 191, 255, 0.8),
                0 0 40px rgba(0, 191, 255, 0.6),
                0 0 60px rgba(0, 191, 255, 0.4);
            background: #00bfff;
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }


        .stars {
            font-size: 4rem;
            color: #ffd700;
            letter-spacing: 5px;
            margin-top: 15px;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }

        /* ç»§ç»­æŒ‰é’® */
        .wish-continue-btn {
            position: absolute;
            bottom: 40px;
            right: 40px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 1s ease, transform 0.3s ease, background 0.3s ease;
            z-index: 8;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .wish-continue-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .wish-effect.active .wish-continue-btn {
            opacity: 1;
        }

        #upInfo {
            display: flex;
            flex-direction: column;
            align-items: center;
            /* æ°´å¹³å±…ä¸­ */
            gap: 0.6rem;
            /* è¡Œé—´è· */
        }

        .up-line {
            display: flex;
            align-items: center;
            /* å›¾æ ‡ä¸æ–‡å­—å‚ç›´å±…ä¸­ */
            justify-content: center;
            gap: 0.4rem;
            /* å›¾æ ‡ä¸æ–‡å­—é—´è· */
        }
    </style>
</head>

<body>
    <!-- äº”æ˜Ÿç¥ˆä¸­ç‰¹æ•ˆå®¹å™¨ -->
    <div id="wishEffect" class="wish-effect">
        <!-- é‡‘å…‰è¿¸å‘æ•ˆæœ -->
        <div class="golden-light"></div>
        <!-- è§’è‰²åç§°å±•ç¤º -->
        <div class="character-name">
            <span class="name-text"></span>
            <div class="stars"></div>
        </div>
        <!-- ç»§ç»­æŒ‰é’® -->
        <button class="wish-continue-btn">
            <i class="fas fa-times"></i>
        </button>
    </div>
    <button id="fullscreen-btn" style="
    position:fixed;
    left:24px;
    bottom:24px;
    z-index:5;
    width:56px;
    height:56px;
    border-radius:50%;
    background:rgba(25,118,210,0.85);
    color:#fff;
    border:none;
    box-shadow:0 4px 16px rgba(0,0,0,0.18);
    font-size:2rem;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:background 0.3s;
">
        <i class="fas fa-expand"></i>
    </button>
    <div style="position:absolute; left:16px; top:16px; z-index:0;">
        <img src="favicon.png" style="width:120px; height:120px;cursor:none">
        </a>
    </div>
    <div style="position:fixed; right:10px; top:10px; z-index:5;">
        <a href="https://sglowq.github.io/2026/2026.png" target="_blank" title="ç‚¹å‡»æŸ¥çœ‹äºŒç»´ç ">
            <img src="2026.png" alt="äºŒç»´ç "
                style="width:5rem; height:5rem; border-radius:10px;cursor:pointer;opacity:0.2">
        </a>
    </div>
    <div class="container">
        <header>
            <h1>2026é«˜è€ƒå€’è®¡æ—¶Ã—ç¥ˆæ„¿ç‚¹å</h1>
        </header>
        <div class="countdown-box" id="daysBox">
            <div class="countdown-value" id="days">365å¤©</div>
        </div>
        <div class="countdown-container">
            <div class="countdown-box">
                <div class="countdown-value" id="hours">24</div>
                <div class="countdown-label">å°æ—¶</div>
            </div>
            <div class="countdown-box">
                <div class="countdown-value" id="minutes">60</div>
                <div class="countdown-label">åˆ†é’Ÿ</div>
            </div>
            <div class="countdown-box">
                <div class="countdown-value" id="seconds">60</div>
                <div class="countdown-label">ç§’</div>
            </div>
            <div class="countdown-box">
                <div class="countdown-value" id="milliseconds">999</div>
                <div class="countdown-label">æ¯«ç§’</div>
            </div>
        </div>

        <div class="motivation-text">
            <div id="hitokoto">åŠ æ²¹å“¦</div>
            <div id="from">ã€ä¸€è¨€ã€æ­£åœ¨åŠ è½½ä¸­~</div>
        </div>
        <div class="motivation-container">
            <div id="pityInfo" style="text-align:center; font-size:1rem; color:#bbdefb;">
                å¿…ä¸­äº”æ˜Ÿ: <span id="fiveStarPityCount">0</span>/90 |
                å¿…ä¸­å››æ˜Ÿ: <span id="fourStarPityCount">0</span>/10
                <div>äº”æ˜Ÿå¿…ä¸­æœ¬æœŸUPçŠ¶æ€: <span id="fiveStarGuarantee" style="color:#ffeb3b;">æœªæ¿€æ´»</span></div>
                <div>å››æ˜Ÿå¿…ä¸­æœ¬æœŸUPçŠ¶æ€: <span id="fourStarGuarantee" style="color:#ffeb3b;">æœªæ¿€æ´»</span></div>
                <div class="motivation-header">
                    <button class="announcement-btn" id="announcement-btn">
                        é—®å·ä¸ç®€ä»‹
                    </button>
                    <i class="fas fa-users"></i>
                    <h2>å…¨ä½“åŒå­¦åŠ æ²¹</h2>
                    <i class="fas fa-heart"></i>
                    <button id="lotteryBtn"></button>
                    <!-- å†å²è®°å½•æŒ‰é’® -->
                    <button class="history-btn" id="history-btn"><i class="fas fa-history"></i></button>
                </div>
            </div>
            <div id="upInfo" style="text-align:center;margin-bottom:1.5rem;font-size:1.2rem;"></div>

            <div class="scrolling-names" id="scrollingNames">
                <!-- åå­—å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <!-- åˆ é™¤ä¸‹æ–¹çš„æç¤ºæ˜¾ç¤º -->
        </div>

        <footer>
            <p>Â© 2025 æ˜Ÿæ¢¦æ•å…‰ | ä¸º2026å±Šè€ƒç”ŸåŠ æ²¹</p>
            <p>æ¯ä¸€å¤©çš„åŠªåŠ›ï¼Œéƒ½åœ¨æ‹‰è¿‘ä¸æ¢¦æƒ³çš„è·ç¦»</p>
        </footer>
    </div>

    <!-- å†å²è®°å½•å¼¹çª— -->
    <div class="history-container" id="history-container">
        <div class="history-content">
            <button class="close-btn" id="close-btn">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="history-title">å½“å‘¨ç¥ˆæ„¿å†å²è®°å½•</h2>
            <div class="history-slider">
                <div class="history-slides" id="history-slides">
                    <!-- å†å²è®°å½•å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            <div class="slider-controls">
                <button class="slider-btn" id="prev-btn" disabled>
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="slider-btn" id="next-btn">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <div class="announcement-container" id="announcement-container">
        <div class="announcement-content">
            <button class="close-btn" id="announcement-close-btn">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="announcement-title">æœ¬ç½‘é¡µç®€ä»‹</h2>
            <div class="announcement-scroll">
                <div class="announcement-item">
                    <h3><i class="fas fa-lightbulb"></i>é—®å·</h4>
                        <a
                            href="https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=DQSIkWdsW0yxEjajBLZtrQAAAAAAAAAAAAN__jMrgodUMlc5UDVMWUxFRElIVFBQNlNMQVVQTU02VS4u">
                            <button class="announcement-btn">ç‚¹å‡»è¿›å…¥é—®å·</button>
                        </a>
                </div>
                <div class="announcement-item">
                    <h3><i class="fas fa-clock"></i> å€’è®¡æ—¶åŠŸèƒ½è¯´æ˜</h3>
                    <p>æœ¬é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºçš„é«˜è€ƒå€’è®¡æ—¶æ˜¯é’ˆå¯¹2026å¹´é«˜è€ƒçš„è®¾å¤‡å®æ—¶å€’è®¡æ—¶ï¼Œç²¾ç¡®åˆ°æ¯«ç§’çº§ã€‚</p>
                    <ul>
                        <li>å€’è®¡æ—¶ç›®æ ‡æ—¥æœŸï¼š2026å¹´06æœˆ07æ—¥00:00:00.000</li>
                        <li>æ˜¾ç¤ºæ ¼å¼ï¼šå¤©ã€æ—¶ã€åˆ†ã€ç§’ã€æ¯«ç§’</li>
                        <li>æ•°æ®æ›´æ–°ï¼šæ¯æ¯«ç§’è‡ªåŠ¨åˆ·æ–°</li>
                    </ul>
                </div>

                <div class="announcement-item">
                    <h3><i class="fas fa-quote-left"></i> ä¸€è¨€åŠŸèƒ½è¯´æ˜</h3>
                    <p>é¡µé¢ä¸­çš„åŠ±å¿—è¯­å¥æ¥è‡ªã€Œä¸€è¨€ã€APIï¼Œæ¯20ç§’è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡ã€‚</p>
                    <ul>
                        <li>æ•°æ®æ¥æºï¼šhitokoto.cn æä¾›çš„å¼€æ”¾API</li>
                        <li>æ›´æ–°é¢‘ç‡ï¼š20ç§’/æ¬¡</li>
                        <li>å†…å®¹ç±»å‹ï¼šåŒ…å«å¤ä»Šä¸­å¤–çš„åè¨€è­¦å¥ã€ç»å…¸å°è¯å’Œæ–‡å­¦è¯­å¥</li>
                    </ul>
                </div>

                <div class="announcement-item">
                    <h3><i class="fas fa-dice"></i> ç¥ˆæ„¿æœºåˆ¶è¯¦ç»†è¯´æ˜</h3>
                    <p>æœ¬ç¥ˆæ„¿ç³»ç»Ÿæ¨¡æ‹Ÿäº†ã€åŸç¥ã€ç¥ˆæ„¿æœºåˆ¶ï¼ŒåŒ…å«ä¿åº•æœºåˆ¶å’ŒUPè§’è‰²è®¾å®šã€‚</p>
                    <h2>æ¦‚ç‡åˆ†å¸ƒ</h2>
                    <ul>
                        <li><span class="five-star">äº”æ˜Ÿ</span>æ¦‚ç‡ï¼š0.6%</li>
                        <li><span class="four-star">å››æ˜Ÿ</span>æ¦‚ç‡ï¼š5.1%</li>
                        <li><span class="three-star">ä¸‰æ˜Ÿ</span>æ¦‚ç‡ï¼š94.3%</li>
                    </ul>
                    <h2>åè¿æŠ½</h2>
                    <ul>
                        <li>é•¿æŒ‰ç¥ˆæ„¿æŒ‰é’®ï¼Œå¯è¿ç»­æŠ½å–10æ¬¡</li>
                        <li>åè¿æŠ½ä¸­è‡³å°‘åŒ…å«1ä¸ª<span class="four-star">å››æ˜Ÿ</span>æˆ–ä»¥ä¸Šè§’è‰²</li>
                    </ul>
                    <h2>ä¿åº•æœºåˆ¶</h2>
                    <ul>
                        <li><strong><span class="five-star">äº”æ˜Ÿ</span>ä¿åº•</strong>ï¼šè¿ç»­89æ¬¡ç¥ˆæ„¿æœªå‡º<span
                                class="five-star">äº”æ˜Ÿ</span>æ—¶ï¼Œç¬¬90æ¬¡ç¥ˆæ„¿å¿…å‡º<span class="five-star">äº”æ˜Ÿ</span></li>
                        <li><strong><span class="four-star">å››æ˜Ÿ</span>ä¿åº•</strong>ï¼šè¿ç»­9æ¬¡ç¥ˆæ„¿æœªå‡º<span
                                class="four-star">å››æ˜Ÿ</span>æ—¶ï¼Œç¬¬10æ¬¡ç¥ˆæ„¿å¿…å‡º<span class="four-star">å››æ˜Ÿ</span></li>
                        <li><strong><span class="five-star">äº”æ˜ŸUP</span>æœºåˆ¶ï¼ˆçŠ¶æ€ä¸æ¸…ç©ºï¼‰</strong>ï¼šå½“è·å¾—<span
                                class="five-star">äº”æ˜Ÿ</span>æ—¶ï¼Œæœ‰50%æ¦‚ç‡ä¸ºå½“æœŸUPè§’è‰²ï¼›è‹¥æœªè·å¾—UPè§’è‰²ï¼Œåˆ™ä¸‹ä¸€æ¬¡<span
                                class="five-star">äº”æ˜Ÿ</span>å¿…å®šä¸ºUPè§’è‰²</li>
                        <li><strong><span class="four-star">å››æ˜ŸUP</span>æœºåˆ¶ï¼ˆçŠ¶æ€ä¸æ¸…ç©ºï¼‰</strong>ï¼šå½“è·å¾—<span
                                class="four-star">å››æ˜Ÿ</span>æ—¶ï¼Œæœ‰50%æ¦‚ç‡ä¸ºå½“æœŸUPè§’è‰²ä¹‹ä¸€ï¼›è‹¥æœªè·å¾—UPè§’è‰²ï¼Œåˆ™ä¸‹ä¸€æ¬¡<span
                                class="four-star">å››æ˜Ÿ</span>å¿…å®šä¸ºUPè§’è‰²</li>
                    </ul>

                    <h2>UPè§’è‰²è§„åˆ™</h2>
                    <ul>
                        <li>æ¯æ¬¡é¡µé¢åˆ·æ–°ä¼šéšæœºé€‰æ‹©1å<span class="five-star">äº”æ˜ŸUP</span>è§’è‰²å’Œ3å<span class="four-star">å››æ˜ŸUP</span>è§’è‰²
                        </li>
                        <li>UPè§’è‰²ä»ç­çº§åŒå­¦åå•ä¸­éšæœºå–å‡ºã€‚</li>
                        <li>UPçŠ¶æ€ä»…åœ¨å½“å‰é¡µé¢æœ‰æ•ˆï¼Œåˆ·æ–°é¡µé¢åä¼šé‡æ–°éšæœºåˆ†é…ã€‚</li>
                    </ul>

                    <h2>å…¶ä»–è§„åˆ™</h2>
                    <ul>
                        <li>ç¥ˆæ„¿æ¬¡æ•°å’Œå°ä¿åº•è®¡æ•°æ¯å‘¨é‡ç½®ï¼ˆåŸºäºæµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼‰</li>
                        <li>å¤§ä¿åº•çŠ¶æ€ï¼ˆå¿…å‡ºUPï¼‰ä¼šæŒç»­åˆ°è·å¾—UPè§’è‰²ä¸ºæ­¢</li>
                        <li>æ¯æ¬¡ç¥ˆæ„¿ä¼šè®°å½•åœ¨ç¥ˆæ„¿å†å²è®°å½•ä¸­ï¼Œå¯æŒ‰æ—¥æœŸæŸ¥çœ‹</li>
                        <li>æ³¨æ„ï¼šé™¤äº†æœ¬æœŸçš„<span class="four-star">å››æ˜ŸUP</span>å’Œ<span
                                class="five-star">äº”æ˜ŸUP</span>å›ºå®šï¼Œå…¶ä½™çš„äººéƒ½æœ‰å¯èƒ½é‡å¤æˆä¸ºæ™®é€šçš„<span class="five-star">äº”æ˜Ÿ</span>ã€<span
                                class="four-star">å››æ˜Ÿ</span>ä»¥åŠ<span class="three-star">ä¸‰æ˜Ÿ</span></li>

                    </ul>
                </div>

                <div class="announcement-item">
                    <h3><i class="fas fa-scroll"></i> åå­—æ»šåŠ¨æ•ˆæœè¯´æ˜</h3>
                    <ul>
                        <li>åå­—åˆ—è¡¨ï¼šåŒ…å«ç­çº§ç›®å‰æ‰€æœ‰åŒå­¦åå­—</li>
                        <li>æ»šåŠ¨æ–¹å¼ï¼šæ— é™å¾ªç¯æ¨ªå‘æ»šåŠ¨</li>
                        <li>åå­—é¡ºåºï¼šæ¯æ¬¡æ¬¡åˆ·æ–°åé‡æ–°éšæœºæ’åˆ—</li>
                        <li>äº¤äº’æ•ˆæœï¼šæ‚¬åœæ—¶åå­—ä¼šæœ‰ä¸Šæµ®æ•ˆæœå’Œç‰¹æ®Šå…‰æ•ˆ</li>
                    </ul>
                </div>

                <div class="announcement-item">
                    <h3><i class="fas fa-history"></i> å†å²è®°å½•åŠŸèƒ½</h3>
                    <p>ç¥ˆæ„¿å†å²è®°å½•åŠŸèƒ½å…è®¸æŸ¥çœ‹å½“å‘¨çš„æ‰€æœ‰ç¥ˆæ„¿ç»“æœã€‚</p>
                    <ul>
                        <li>æŸ¥çœ‹æ–¹å¼ï¼šç‚¹å‡»å³ä¾§å†å²è®°å½•æŒ‰é’®ï¼ˆå›æº¯æ—¶é’Ÿå›¾æ ‡ï¼‰</li>
                        <li>è®°å½•å†…å®¹ï¼šåŒ…å«ç¥ˆä¸­è§’è‰²ã€ç¨€æœ‰åº¦å’Œç¥ˆæ„¿æ—¶é—´</li>
                        <li>åˆ†ç»„æ˜¾ç¤ºï¼šæ¯5æ¡è®°å½•ä¸ºä¸€ç»„ï¼Œæ”¯æŒè·³è½¬</li>
                        <li>æ•°æ®å­˜å‚¨ï¼šä½¿ç”¨æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼Œä»…ä¿å­˜å½“å‘¨è®°å½•ã€‚</li>

                        <li>ç¨€æœ‰åº¦æ ‡è¯†ï¼š<span class="five-star">äº”æ˜Ÿ</span>ã€<span class="four-star">å››æ˜Ÿ</span>ã€<span
                                class="three-star">ä¸‰æ˜Ÿ</span></li>
                        <li>æ³¨æ„ï¼šå› ä¸ºæ¯æ¬¡åˆ·æ–°é¡µé¢åï¼Œåå­—çš„upå’Œæ˜Ÿçº§éƒ½ä¼šæ”¹å˜ï¼Œå¯èƒ½æœ‰ä¸€ä¸ªäººçš„åå­—æœ‰ä¸åŒçš„ç­‰çº§</li>
                    </ul>
                </div>

                <script>
                    // ç¦æ­¢å³é”®
                    document.addEventListener('contextmenu', function (event) {
                        event.preventDefault();
                    });

                    // è®¾ç½®é«˜è€ƒæ—¥æœŸï¼ˆ2026å¹´6æœˆ7æ—¥ï¼‰
                    const examDate = new Date('June 7, 2026 00:00:00').getTime();

                    // å…¨å±åŠŸèƒ½
                    const fullscreenBtn = document.getElementById('fullscreen-btn');
                    fullscreenBtn.addEventListener('click', function () {
                        if (!document.fullscreenElement) {
                            document.documentElement.requestFullscreen();
                            fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                        } else {
                            document.exitFullscreen();
                            fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                        }
                    });

                    document.addEventListener('fullscreenchange', function () {
                        if (!document.fullscreenElement) {
                            fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                        }
                    });

                    // æ›´æ–°å€’è®¡æ—¶
                    function updateCountdown() {
                        const now = new Date().getTime();
                        let distance = examDate - now;

                        // å¦‚æœæ—¶é—´å·²åˆ°ï¼Œå…¨éƒ¨å½’é›¶
                        if (distance <= 0) {
                            document.getElementById('days').innerText = "0å¤©";
                            document.getElementById('hours').innerText = "00";
                            document.getElementById('minutes').innerText = "00";
                            document.getElementById('seconds').innerText = "00";
                            document.getElementById('milliseconds').innerText = "000";
                            return; // ä¸å†é€’å½’è°ƒç”¨
                        }

                        // è®¡ç®—å¤©ã€æ—¶ã€åˆ†ã€ç§’ã€æ¯«ç§’
                        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                        const hours = Math.floor(distance / (1000 * 60 * 60));
                        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                        const milliseconds = Math.floor(distance % 1000);

                        // æ›´æ–°æ˜¾ç¤º
                        document.getElementById('days').innerText = days + "å¤©";
                        document.getElementById('hours').innerText = hours.toString().padStart(2, '0');
                        document.getElementById('minutes').innerText = minutes.toString().padStart(2, '0');
                        document.getElementById('seconds').innerText = seconds.toString().padStart(2, '0');
                        document.getElementById('milliseconds').innerText = milliseconds.toString().padStart(3, '0');

                        requestAnimationFrame(updateCountdown);
                    }

                    // ä¸€è¨€åŠŸèƒ½
                    let hitokotoInterval;
                    let isUpdating = false;
                    let isHitokotoVisible = true;

                    function updateHitokoto() {
                        if (isUpdating || !isHitokotoVisible) return;

                        isUpdating = true;
                        fetch('https://v1.hitokoto.cn')
                            .then(response => response.json())
                            .then(data => {
                                const hitokoto = data.hitokoto || '';
                                const from = data.from ? `ã€${data.from}ã€` : '';
                                const fromWho = data.from_who ? `${data.from_who}` : '';

                                // æ·¡å‡ºæ•ˆæœ
                                const hitokotoElement = document.getElementById('hitokoto');
                                const fromElement = document.getElementById('from');

                                hitokotoElement.style.transition = 'opacity 0.5s ease';
                                fromElement.style.transition = 'opacity 0.5s ease';
                                hitokotoElement.style.opacity = 0;
                                fromElement.style.opacity = 0;

                                // ç­‰å¾…æ·¡å‡ºå®Œæˆåå†æ›´æ–°å†…å®¹
                                setTimeout(() => {
                                    hitokotoElement.innerText = hitokoto;
                                    fromElement.innerText = from + fromWho;
                                    fromElement.style.fontSize = '20px';

                                    // æ·¡å…¥æ•ˆæœ
                                    hitokotoElement.style.opacity = 1;
                                    fromElement.style.opacity = 1;

                                    // åŠ¨ç”»å®Œæˆåé‡ç½®transitionå±æ€§
                                    setTimeout(() => {
                                        hitokotoElement.style.transition = '';
                                        fromElement.style.transition = '';
                                        isUpdating = false;
                                    }, 500);
                                }, 500);
                            })
                            .catch(console.error);
                    }

                    // é—®å·ä¸ç®€ä»‹åŠŸèƒ½
                    const announcementBtn = document.getElementById('announcement-btn');
                    const announcementContainer = document.getElementById('announcement-container');
                    const announcementCloseBtn = document.getElementById('announcement-close-btn');

                    announcementBtn.addEventListener('click', function () {
                        announcementContainer.style.display = 'flex';
                    });

                    announcementCloseBtn.addEventListener('click', function () {
                        announcementContainer.style.display = 'none';
                    });

                    announcementContainer.addEventListener('click', function (e) {
                        if (e.target === this) {
                            this.style.display = 'none';
                        }
                    });

                    // Fisher-Yates æ´—ç‰Œç®—æ³•
                    function shuffleArray(array) {
                        const newArray = [...array];
                        for (let i = newArray.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
                        }
                        return newArray;
                    }

                    // å…ƒç´ å›¾æ ‡è¡¨
                    const elementMap = [
                        { char: '\ue001', color: 'var(--pyro)' },
                        { char: '\ue002', color: 'var(--hydro)' },
                        { char: '\ue003', color: 'var(--anemo)' },
                        { char: '\ue004', color: 'var(--electro)' },
                        { char: '\ue005', color: 'var(--dendro)' },
                        { char: '\ue006', color: 'var(--cryo)' },
                        { char: '\ue007', color: 'var(--geo)' }
                    ];

                    // ç”Ÿæˆå¸¦éšæœºå…ƒç´ å›¾æ ‡çš„åå­—æ•°ç»„
                    const students = [
                        "å¼ æ°¸æ²›", "é›·ä¿Šæ°", "é™ˆé¦¨æ€¡", "æ®·ä¿Šå¼º", "éƒ‘å¥", "æä¾å©·", "ç‹ä¿Šæ¥ ",
                        "è´ºæ¢¦è²", "é»„é‡‘å©·", "å…°é›¨æª", "è‚–æ¶µ", "é™ˆæ…§ä¸½", "å´”é›¯", "é©¬è‹±å®¸",
                        "é˜®æ–¹é’°", "è¢å“å³°", "å¾å•Ÿé”", "åˆ˜ä¸€å‡¡", "æå¥", "éŸ¦å—æ¥ ",
                        "é˜®å¿ƒæ€¡", "æ¨ç‰è‰º", "è´ºé¹åŸ", "åˆ˜è‰ºæ ‹", "é™ˆæ™¨", "æ¨Šçµ",
                        "æ¯›æŒ¯å®‡", "å¾é¦¨", "ç´¢ä¿Šä¿Š", "é™ˆé‘«", "å¾ä¸€å¸†", "åˆ˜æ™¨é˜³",
                        "å´é‡‘æ˜Š", "é˜®ç®", "ä»£è‰³å…´", "ç†Šå¨œ", "æŸ¥é’°é’’",
                        "ç¨‹ç³ç³", "æŸ¯è´¤å¨", "èŒ¹å®˜æ—º", "æ¯›é™é›¯", "æœ±æ²»é”¦", "æ¨èµ·æµ©",
                        "æ¨µä¸–è¯š", "ç†Šå¨…å¦®", "é»„æµ·æ£ ", "ç¨‹ä¿®å‡", "å¼ ç»´å“²", "å¾å¯æ¬£",
                        "å¼ é’°ç®", "å¤å¢å©·", "å´æ˜Šæ˜Š", "å‘¨ç¬ ", "ä»»é¹é£", "è°¢æ˜Œå†œ",
                        "ç¨‹å‡¯", "æœ±æµ·è‹±", "é»„ä½³è¾‰", "æ›¹æ—–è¯º", "è°¢æ˜“èˆª", "å·©ç‰è“‰"
                    ].map((name) => {
                        const randomIndex = Math.floor(Math.random() * elementMap.length);
                        const el = elementMap[randomIndex];
                        return `<i style="font-family:Elements;font-size:1.4rem;color:${el.color};margin-right:6px;font-style:normal;">${el.char}</i>${name}`;
                    });

                    // éšæœºé€‰UPè§’è‰²
                    function pickUPs(arr, count) {
                        const copy = [...arr];
                        const result = [];
                        for (let i = 0; i < count; i++) {
                            const idx = Math.floor(Math.random() * copy.length);
                            result.push(copy[idx]);
                            copy.splice(idx, 1);
                        }
                        return result;
                    }

                    // é¡µé¢åˆ·æ–°æ—¶éšæœºUP
                    let fiveStarUP = pickUPs(students, 1)[0];
                    let fourStarUPs = pickUPs(students.filter(s => s !== fiveStarUP), 3);

                    // å±•ç¤ºUPä¿¡æ¯
                    function updateUPDisplay() {
                        const fiveIcon = fiveStarUP.match(/<i[^>]*>.*?<\/i>/)[0];
                        const fiveText = fiveStarUP.replace(/<i[^>]*>.*?<\/i>/, '');

                        const fourHtml = fourStarUPs.map(n => {
                            const icon = n.match(/<i[^>]*>.*?<\/i>/)[0];
                            const txt = n.replace(/<i[^>]*>.*?<\/i>/, '');
                            return `${icon}<span style="background:linear-gradient(90deg,#A259FF,#8F5AFF);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;font-weight:bold;">${txt}</span>`;
                        }).join('&nbsp;&nbsp;&nbsp;&nbsp;');

                        document.getElementById('upInfo').innerHTML = `
        <div class="up-line">
            <span style="font-weight:bold;color:#FFD700;">äº”æ˜ŸUPï¼š</span>
            ${fiveIcon}
            <span style="background:linear-gradient(90deg,#FFD700,#FFA500);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;font-weight:bold;">${fiveText}</span>
        </div>
        <div class="up-line">
            <span style="font-weight:bold;color:#A259FF;">å››æ˜ŸUPï¼š</span>
            ${fourHtml}
        </div>
    `;
                    }

                    const shuffledStudents = shuffleArray(students);

                    function generateScrollingNames() {
                        const container = document.getElementById('scrollingNames');
                        container.innerHTML = '';
                        const doubleList = [...shuffledStudents, ...shuffledStudents];
                        doubleList.forEach(student => {
                            const nameElement = document.createElement('div');
                            nameElement.className = 'name-item';
                            nameElement.innerHTML = student;
                            container.appendChild(nameElement);
                        });
                    }

                    // ç¨€æœ‰åº¦é…ç½®
                    const rarityConfig = [
                        { name: 'â­â­â­â­â­', color: 'linear-gradient(90deg,#FFD700,#FFA500)', textColor: '#000', chance: 0.006 },
                        { name: 'â­â­â­â­', color: 'linear-gradient(90deg,#A259FF,#8F5AFF)', textColor: '#fff', chance: 0.051 },
                        { name: 'â­â­â­', color: 'linear-gradient(90deg,#00bfff,#1e90ff)', textColor: '#fff', chance: 0.943 }
                    ];

                    // è·å–å½“å‰æ˜¯ç¬¬å‡ å‘¨
                    function getWeekNumber(date = new Date()) {
                        const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
                        const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
                        return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay()) / 7);
                    }

                    // è·å–æœ¬å‘¨key
                    function getWeekKey(key) {
                        const today = new Date();
                        const week = getWeekNumber(today);
                        return key + '_' + today.getFullYear() + '_W' + week;
                    }

                    // è·å–ä¿åº•æ¬¡æ•°
                    function getPity(key, defaultValue = 0) {
                        const weekKey = getWeekKey(key);
                        const value = localStorage.getItem(weekKey);
                        return value ? parseInt(value) : defaultValue;
                    }

                    // è®¾ç½®ä¿åº•æ¬¡æ•°
                    function setPity(key, value) {
                        const weekKey = getWeekKey(key);
                        localStorage.setItem(weekKey, value);
                    }

                    // åˆå§‹åŒ–ä¿åº•
                    let totalDraws = getPity('totalDraws', 0);
                    let fiveStarPity = getPity('fiveStarPity', 0);
                    let fourStarPity = getPity('fourStarPity', 0);

                    // å¤§ä¿åº•çŠ¶æ€å˜é‡
                    let isGuaranteed5StarUP = localStorage.getItem('isGuaranteed5StarUP') === 'true';
                    let isGuaranteed4StarUP = localStorage.getItem('isGuaranteed4StarUP') === 'true';

                    // æ›´æ–°ä¿åº•ä¿¡æ¯æ˜¾ç¤º
                    function updatePityDisplay() {
                        document.getElementById('fiveStarPityCount').innerHTML = fiveStarPity;
                        document.getElementById('fourStarPityCount').innerHTML = fourStarPity;
                        document.getElementById('fiveStarGuarantee').innerHTML = isGuaranteed5StarUP ? "å·²æ¿€æ´»" : "æœªæ¿€æ´»";
                        document.getElementById('fourStarGuarantee').innerHTML = isGuaranteed4StarUP ? "å·²æ¿€æ´»" : "æœªæ¿€æ´»";

                        document.getElementById('fiveStarGuarantee').style.color = isGuaranteed5StarUP ? "#00ff00" : "#ffeb3b";
                        document.getElementById('fourStarGuarantee').style.color = isGuaranteed4StarUP ? "#00ff00" : "#ffeb3b";
                    }

                    // ç¥ˆæ„¿æŒ‰é’®æ–‡æœ¬æ˜¾ç¤ºç¥ˆæ„¿æ¬¡æ•°
                    function updateLotteryBtnText() {
                        lotteryBtn.innerText = `ç¥ˆæ„¿` + '\n' + `ï¼ˆç´¯è®¡${totalDraws}æ¬¡ï¼‰`;
                    }

                    // è·å–æœ¬å‘¨å†å²è®°å½•key
                    function getHistoryKey() {
                        const today = new Date();
                        const week = getWeekNumber(today);
                        return 'gachaHistory_' + today.getFullYear() + '_W' + week;
                    }

                    // æ·»åŠ å†å²è®°å½•
                    function addHistoryRecord(name, rarity, isUP) {
                        const historyKey = getHistoryKey();
                        const history = JSON.parse(localStorage.getItem(historyKey) || '[]');

                        const now = new Date();
                        const dateStr = `${now.getFullYear()}-${(now.getMonth() + 1).toString().padStart(2, '0')}-${now.getDate().toString().padStart(2, '0')}`;
                        const timeStr = now.toLocaleTimeString();

                        const newRecord = {
                            name: name,
                            rarity: rarity,
                            isUP: isUP,
                            date: dateStr,
                            time: timeStr
                        };

                        history.unshift(newRecord);
                        localStorage.setItem(historyKey, JSON.stringify(history));
                    }

                    // é«˜äº®åå­—å‡½æ•°
                    function highlightWinner(winnerName, rarityIndex) {
                        // å…ˆé‡ç½®æ‰€æœ‰åå­—çš„æ ·å¼
                        scrollingNames.childNodes.forEach(el => {
                            el.style.background = '';
                            el.style.color = '';
                            el.style.fontWeight = '';
                            el.style.boxShadow = '';
                            el.style.border = '';
                        });

                        // ç„¶åé«˜äº®æ‰€æœ‰åŒ¹é…çš„åå­—ï¼ˆä¸¤ä¸ªåå•éƒ½é«˜äº®ï¼‰
                        scrollingNames.childNodes.forEach((el, i) => {
                            if (el.innerHTML === winnerName) {
                                el.style.background = rarityConfig[rarityIndex].color;
                                el.style.color = rarityConfig[rarityIndex].textColor;
                                el.style.fontWeight = 'bold';
                                el.style.boxShadow = rarityIndex === 0 ? '0 0 32px 12px #FFD700' :
                                    rarityIndex === 1 ? '0 0 24px 8px #A259FF' :
                                        '0 0 16px 6px #00bfff';
                                el.style.border = rarityIndex === 0 ? '3px solid #FFD700' :
                                    rarityIndex === 1 ? '3px solid #A259FF' :
                                        '3px solid #00bfff';
                            }
                        });
                    }

                    // ç¥ˆæ„¿åŠŸèƒ½
                    const lotteryBtn = document.getElementById('lotteryBtn');
                    const scrollingNames = document.getElementById('scrollingNames');
                    let isRolling = false;

                    // åè¿æŠ½ç›¸å…³å˜é‡
                    let isTenPullMode = false;
                    let longPressTimer = null;
                    const LONG_PRESS_DURATION = 500; // é•¿æŒ‰0.5ç§’è§¦å‘åè¿

                    // ä¿®å¤ç‚¹å‡»/é•¿æŒ‰æœºåˆ¶
                    lotteryBtn.addEventListener('mousedown', function (e) {
                        e.preventDefault(); // é˜²æ­¢é»˜è®¤è¡Œä¸º
                        startLongPress();
                    });

                    lotteryBtn.addEventListener('touchstart', function (e) {
                        e.preventDefault(); // é˜²æ­¢é»˜è®¤è¡Œä¸º
                        startLongPress();
                    });

                    lotteryBtn.addEventListener('mouseup', function (e) {
                        e.preventDefault(); // é˜²æ­¢é»˜è®¤è¡Œä¸º
                        cancelLongPress();
                    });

                    lotteryBtn.addEventListener('touchend', function (e) {
                        e.preventDefault(); // é˜²æ­¢é»˜è®¤è¡Œä¸º
                        cancelLongPress();
                    });

                    // é˜²æ­¢é¼ æ ‡ç§»å‡ºæ—¶è¯¯è§¦å‘
                    lotteryBtn.addEventListener('mouseleave', function () {
                        if (longPressTimer) {
                            clearTimeout(longPressTimer);
                            longPressTimer = null;
                            // é‡ç½®æŒ‰é’®çŠ¶æ€
                            lotteryBtn.innerText = `ç¥ˆæ„¿` + '\n' + `ï¼ˆç´¯è®¡${totalDraws}æ¬¡ï¼‰`;
                            isTenPullMode = false;
                        }
                    });

                    function startLongPress() {
                        if (isRolling) return;

                        longPressTimer = setTimeout(() => {
                            isTenPullMode = true;
                            lotteryBtn.innerText = 'åè¿æŠ½ä¸­...';
                        }, LONG_PRESS_DURATION);
                    }

                    function cancelLongPress() {
                        if (longPressTimer) {
                            clearTimeout(longPressTimer);
                            longPressTimer = null;
                        }

                        if (isRolling) return;

                        // å¦‚æœæ˜¯é•¿æŒ‰è§¦å‘çš„åè¿æŠ½æ¨¡å¼
                        if (isTenPullMode) {
                            performTenPull();
                        }
                        // å¦‚æœæ˜¯çŸ­æŒ‰è§¦å‘çš„å•æŠ½
                        else {
                            performSinglePull();
                        }
                    }

                    // å•æŠ½å‡½æ•° - åˆ é™¤æ»šåŠ¨åŠ¨ç”»
                    function performSinglePull() {
                        if (isRolling) return;
                        isRolling = true;

                        // ç›´æ¥æŠ½å–ç»“æœ
                        const result = drawOne();

                        // æ·»åŠ å†å²è®°å½• - è¿™æ˜¯ä¿®å¤çš„å…³é”®
                        addHistoryRecord(result.winnerName, result.rarityIndex, result.isUP);

                        // é«˜äº®ä¸­å¥–åå­—
                        highlightWinner(result.winnerName, result.rarityIndex);

                        // æ˜¾ç¤ºç‰¹æ•ˆ
                        showFiveStarEffect(result.winnerName, result.rarityIndex, result.isUP, function () {
                            isRolling = false;
                            isTenPullMode = false;
                            updateLotteryBtnText();
                        });
                    }

                    // åè¿æŠ½å‡½æ•° - ä¿®æ­£ç‰ˆæœ¬
                    function performTenPull() {
                        if (isRolling) return;
                        isRolling = true;

                        // ä¸€æ¬¡æ€§æŠ½å–10æ¬¡ç»“æœ
                        const results = [];
                        for (let i = 0; i < 10; i++) {
                            results.push(drawOne());
                        }

                        // ç«‹å³è®°å½•æ‰€æœ‰å†å²è®°å½•
                        results.forEach(result => {
                            addHistoryRecord(result.winnerName, result.rarityIndex, result.isUP);
                        });

                        // ä¾æ¬¡æ˜¾ç¤ºåè¿æŠ½ç»“æœï¼Œæ‰€æœ‰ç»“æœéƒ½ç”¨ç‰¹æ•ˆæ˜¾ç¤º
                        showTenPullResults(results);
                    }

                    // æ˜¾ç¤ºåè¿æŠ½ç»“æœ - ä¿®æ”¹ä¸ºæœ€åç»Ÿä¸€é«˜äº®
                    function showTenPullResults(results) {
                        let currentIndex = 0;
                        lotteryBtn.innerText = 'åè¿æŠ½ä¸­...';

                        // å…ˆæ”¶é›†æ‰€æœ‰è¦æ˜¾ç¤ºçš„ç»“æœï¼Œä½†ä¸ç«‹å³é«˜äº®
                        function showNextResult() {
                            if (currentIndex < results.length) {
                                const result = results[currentIndex];

                                // æ‰€æœ‰æ˜Ÿçº§éƒ½ç”¨ç‰¹æ•ˆæ˜¾ç¤ºï¼Œåªæ˜¯é¢œè‰²ä¸åŒ
                                showFiveStarEffect(result.winnerName, result.rarityIndex, result.isUP, function () {
                                    currentIndex++;
                                    showNextResult();
                                });
                            } else {
                                // æ‰€æœ‰ç»“æœæ˜¾ç¤ºå®Œæ¯•åï¼Œç»Ÿä¸€é«˜äº®æ‰€æœ‰åå­—
                                highlightAllTenPullResults(results);
                                finishTenPull();
                            }
                        }

                        showNextResult();
                    }

                    // æ–°å¢å‡½æ•°ï¼šç»Ÿä¸€é«˜äº®åè¿æŠ½çš„æ‰€æœ‰ç»“æœ
                    // æ‰¾åˆ°è¿™ä¸ªå‡½æ•°ï¼Œä¿®æ”¹å¾ªç¯é€»è¾‘
                    function highlightAllTenPullResults(results) {
                        // å…ˆé‡ç½®æ‰€æœ‰åå­—çš„æ ·å¼
                        scrollingNames.childNodes.forEach(el => {
                            el.style.background = '';
                            el.style.color = '';
                            el.style.fontWeight = '';
                            el.style.boxShadow = '';
                            el.style.border = '';
                        });

                        // ç„¶åé«˜äº®æ‰€æœ‰ä¸­å¥–çš„åå­—ï¼ˆä¸¤ä¸ªåå•éƒ½é«˜äº®ï¼‰
                        results.forEach(result => {
                            const winnerName = result.winnerName;
                            const rarityIndex = result.rarityIndex;

                            // æ‰¾åˆ°æ‰€æœ‰åŒ¹é…çš„åå­—ä½ç½®ï¼ˆä¸¤ä¸ªåå•éƒ½é«˜äº®ï¼‰
                            scrollingNames.childNodes.forEach((el, i) => {
                                if (el.innerHTML === winnerName) {
                                    el.style.background = rarityConfig[rarityIndex].color;
                                    el.style.color = rarityConfig[rarityIndex].textColor;
                                    el.style.fontWeight = 'bold';
                                    el.style.boxShadow = rarityIndex === 0 ? '0 0 32px 12px #FFD700' :
                                        rarityIndex === 1 ? '0 0 24px 8px #A259FF' :
                                            '0 0 16px 6px #00bfff';
                                    el.style.border = rarityIndex === 0 ? '3px solid #FFD700' :
                                        rarityIndex === 1 ? '3px solid #A259FF' :
                                            '3px solid #00bfff';
                                }
                            });
                        });
                    }

                    // æ˜¾ç¤ºäº”æ˜Ÿå¤§ç‰¹æ•ˆ - ä¿®æ­£ç‰ˆæœ¬ï¼Œæ”¯æŒæ‰€æœ‰æ˜Ÿçº§
                    function showFiveStarEffect(name, rarityIndex, isUP, onClose) {
                        const effectContainer = document.getElementById('wishEffect');
                        const goldenLight = effectContainer.querySelector('.golden-light');
                        const characterName = effectContainer.querySelector('.character-name');
                        const nameText = effectContainer.querySelector('.name-text');
                        const starsElement = effectContainer.querySelector('.stars');

                        // ç§»é™¤æ‰€æœ‰æ˜Ÿçº§ç±»ï¼Œåªä¿ç•™åŸºç¡€ç±»
                        nameText.className = 'name-text';

                        // æ ¹æ®ç¨€æœ‰åº¦è®¾ç½®é¢œè‰²å’Œæ˜Ÿæ˜Ÿ
                        let color, stars, lightColor;
                        if (rarityIndex === 0) {
                            color = '#FFD700';
                            stars = 'â­â­â­â­â­';
                            lightColor = 'rgba(255, 215, 0, 0.8)'; // é‡‘è‰²
                        } else if (rarityIndex === 1) {
                            color = '#A259FF';
                            stars = 'â­â­â­â­';
                            lightColor = 'rgba(162, 89, 255, 0.8)'; // ç´«è‰²
                        } else {
                            color = '#00bfff';
                            stars = 'â­â­â­';
                            lightColor = 'rgba(0, 191, 255, 0.8)'; // è“è‰²
                        }

                        // è®¾ç½®æ˜Ÿæ˜Ÿå’Œé¢œè‰²
                        starsElement.innerHTML = stars;
                        starsElement.style.color = color;

                        // è®¾ç½®é‡‘å…‰é¢œè‰²
                        goldenLight.style.background = `radial-gradient(circle, rgba(255, 255, 255, 0) 0%, ${lightColor} 40%, ${lightColor} 70%)`;

                        // æ·»åŠ UPæ ‡è®°
                        const upMark = isUP ? ' UP!' : '';
                        // æ’­æ”¾éŸ³æ•ˆï¼ˆæ ¹æ®ç¨€æœ‰åº¦æ’­æ”¾ä¸åŒçš„éŸ³æ•ˆï¼‰
                        let audioToPlay = null;
                        if (rarityIndex === 0) {
                            audioToPlay = document.getElementById('fiveStarSound'); // äº”æ˜ŸéŸ³æ•ˆ
                        } else if (rarityIndex === 1) {
                            audioToPlay = document.getElementById('fourStarSound'); // å››æ˜ŸéŸ³æ•ˆ
                        } else {
                            audioToPlay = document.getElementById('threeStarSound'); // ä¸‰æ˜ŸéŸ³æ•ˆ
                        }

                        if (audioToPlay) {
                            audioToPlay.currentTime = 0;
                            audioToPlay.play().catch(error => {
                                console.log('éŸ³é¢‘è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’:', error);
                            });
                        }

                        // è§£æåå­—ï¼Œåˆ†ç¦»å…ƒç´ ç¬¦å·å’Œæ–‡æœ¬
                        const tempDiv = document.createElement('div');
                        tempDiv.innerHTML = name;

                        let elementHTML = '';
                        let pureName = name;

                        // å¦‚æœæœ‰å…ƒç´ ç¬¦å·ï¼Œæå–å‡ºæ¥
                        if (tempDiv.querySelector('i')) {
                            elementHTML = tempDiv.innerHTML.match(/<i[^>]*>.*?<\/i>/)[0];
                            elementHTML = elementHTML.replace('font-size:1.4rem', 'font-size:3rem;font-weight:normal');
                            pureName = name.replace(/<i[^>]*>.*?<\/i>/, '');
                        }

                        // è®¾ç½®åå­—æ˜¾ç¤ºï¼Œå…ƒç´ ç¬¦å·ä¿æŒåŸè‰²ï¼Œåªæœ‰æ–‡æœ¬éƒ¨åˆ†åº”ç”¨ç‰¹æ•ˆ
                        nameText.innerHTML = elementHTML + `<span class="${rarityIndex === 0 ? 'five-star-effect' : rarityIndex === 1 ? 'four-star-effect' : 'three-star-effect'}">${pureName}${upMark}</span>`;

                        // æ˜¾ç¤ºç‰¹æ•ˆå®¹å™¨
                        effectContainer.classList.add('active');

                        // åŠ¨ç”»åºåˆ—
                        setTimeout(() => {
                            goldenLight.style.animation = 'goldenLightAnimation 1.25s ease-out forwards';
                            goldenLight.style.opacity = '1';
                            characterName.classList.add('revealed');
                        });

                        // é‡æ–°ç»‘å®šå…³é—­äº‹ä»¶
                        const continueBtn = effectContainer.querySelector('.wish-continue-btn');
                        continueBtn.onclick = function () {
                            goldenLight.style.animation = 'none';
                            goldenLight.style.opacity = '0';
                            characterName.classList.remove('revealed');
                            effectContainer.classList.remove('active');

                            if (onClose) {
                                onClose();
                            }
                        };
                    }

                    // å®Œæˆåè¿æŠ½
                    function finishTenPull() {
                        isRolling = false;
                        isTenPullMode = false;
                        updateLotteryBtnText();
                    }

                    // æŠ½å¡æ ¸å¿ƒé€»è¾‘
                    function drawOne() {
                        // ä¿åº•æœºåˆ¶
                        let rarityIndex = 2;
                        totalDraws++;
                        fiveStarPity++;
                        fourStarPity++;

                        if (fiveStarPity >= 90) {
                            rarityIndex = 0;
                            fiveStarPity = 0;
                            fourStarPity = 0;
                        } else if (fourStarPity >= 10) {
                            rarityIndex = 1;
                            fourStarPity = 0;
                        } else {
                            const rand = Math.random();
                            if (rand < rarityConfig[0].chance) {
                                rarityIndex = 0;
                                fiveStarPity = 0;
                                fourStarPity = 0;
                            } else if (rand < rarityConfig[0].chance + rarityConfig[1].chance) {
                                rarityIndex = 1;
                                fourStarPity = 0;
                            }
                        }

                        // ä¿å­˜ç¥ˆæ„¿æ¬¡æ•°
                        setPity('totalDraws', totalDraws);
                        setPity('fiveStarPity', fiveStarPity);
                        setPity('fourStarPity', fourStarPity);

                        updateLotteryBtnText();

                        // å†³å®šä¸­å¥–äºº
                        let winnerName = '';
                        let isUP = false;
                        if (rarityIndex === 0) {
                            fiveStarPity = 0;
                            fourStarPity = 0;

                            if (isGuaranteed5StarUP) {
                                winnerName = fiveStarUP;
                                isUP = true;
                                isGuaranteed5StarUP = false;
                            } else {
                                if (Math.random() < 0.5) {
                                    winnerName = fiveStarUP;
                                    isUP = true;
                                } else {
                                    const candidates = students.filter(s => s !== fiveStarUP);
                                    winnerName = candidates[Math.floor(Math.random() * candidates.length)];
                                    isUP = false;
                                    isGuaranteed5StarUP = true;
                                }
                            }

                            localStorage.setItem('isGuaranteed5StarUP', isGuaranteed5StarUP);
                        } else if (rarityIndex === 1) {
                            fourStarPity = 0;

                            if (isGuaranteed4StarUP) {
                                winnerName = fourStarUPs[Math.floor(Math.random() * fourStarUPs.length)];
                                isUP = true;
                                isGuaranteed4StarUP = false;
                            } else {
                                if (Math.random() < 0.5) {
                                    winnerName = fourStarUPs[Math.floor(Math.random() * fourStarUPs.length)];
                                    isUP = true;
                                } else {
                                    const candidates = students.filter(s => !fourStarUPs.includes(s) && s !== fiveStarUP);
                                    winnerName = candidates[Math.floor(Math.random() * candidates.length)];
                                    isUP = false;
                                    isGuaranteed4StarUP = true;
                                }
                            }

                            localStorage.setItem('isGuaranteed4StarUP', isGuaranteed4StarUP);
                        } else {
                            const candidates = students.filter(s => !fourStarUPs.includes(s) && s !== fiveStarUP);
                            winnerName = candidates[Math.floor(Math.random() * candidates.length)];
                        }

                        updatePityDisplay();

                        // ä¿å­˜çŠ¶æ€
                        setPity('totalDraws', totalDraws);
                        setPity('fiveStarPity', fiveStarPity);
                        setPity('fourStarPity', fourStarPity);
                        localStorage.setItem('isGuaranteed5StarUP', isGuaranteed5StarUP);
                        localStorage.setItem('isGuaranteed4StarUP', isGuaranteed4StarUP);

                        return {
                            winnerName,
                            rarityIndex,
                            isUP
                        };
                    }

                    // å†å²è®°å½•ç›¸å…³åŠŸèƒ½
                    let currentSlide = 0;
                    let totalSlides = 0;

                    // æ˜¾ç¤ºå†å²è®°å½•
                    function showHistory() {
                        const historyKey = getHistoryKey();
                        const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
                        const slidesContainer = document.getElementById('history-slides');

                        slidesContainer.innerHTML = '';

                        if (history.length === 0) {
                            slidesContainer.innerHTML = '<div class="no-history">æœ¬å‘¨æš‚æ— ç¥ˆæ„¿è®°å½•</div>';
                            document.getElementById('prev-btn').disabled = true;
                            document.getElementById('next-btn').disabled = true;
                            document.getElementById('history-container').style.display = 'flex';
                            return;
                        }

                        totalSlides = Math.ceil(history.length / 5);
                        currentSlide = 0;

                        document.getElementById('prev-btn').disabled = true;
                        document.getElementById('next-btn').disabled = totalSlides <= 1;

                        for (let i = 0; i < totalSlides; i++) {
                            const group = document.createElement('div');
                            group.className = 'history-group';

                            const groupHeader = document.createElement('div');
                            groupHeader.className = 'group-header';

                            const groupTitle = document.createElement('div');
                            groupTitle.className = 'group-title';
                            groupTitle.innerHTML = `ç¬¬ ${i + 1} é¡µ / å…± ${totalSlides} é¡µ`;

                            groupHeader.appendChild(groupTitle);
                            group.appendChild(groupHeader);

                            for (let j = i * 5; j < Math.min((i + 1) * 5, history.length); j++) {
                                const record = history[j];
                                const item = document.createElement('div');
                                item.className = 'history-item';

                                const nameSpan = document.createElement('span');
                                nameSpan.className = 'item-name';
                                nameSpan.innerHTML = record.name;

                                const raritySpan = document.createElement('span');
                                raritySpan.className = 'item-rarity';

                                if (record.rarity === 0) {
                                    raritySpan.classList.add('five-star');
                                    raritySpan.innerHTML = 'äº”æ˜Ÿ' + (record.isUP ? ' UP!' : '');
                                    nameSpan.style.color = '#FFD700';
                                } else if (record.rarity === 1) {
                                    raritySpan.classList.add('four-star');
                                    raritySpan.innerHTML = 'å››æ˜Ÿ' + (record.isUP ? ' UP!' : '');
                                    nameSpan.style.color = '#A259FF';
                                } else {
                                    raritySpan.classList.add('three-star');
                                    raritySpan.innerHTML = 'ä¸‰æ˜Ÿ';
                                    nameSpan.style.color = '#03a9f4';
                                }

                                const timeSpan = document.createElement('span');
                                timeSpan.className = 'item-time';
                                timeSpan.innerHTML = (record.date ? record.date : '') + ' ' + record.time;

                                item.appendChild(nameSpan);
                                item.appendChild(raritySpan);
                                item.appendChild(timeSpan);

                                group.appendChild(item);
                            }

                            slidesContainer.appendChild(group);
                        }

                        const pageJumpHTML = `
        <input type="number" id="page-input" min="1" max="${totalSlides}" value="1"
            style="width:108px;height:36px;text-align:center;border:1px solid #90caf9;border-radius:8px;padding:0 8px;
            font-size:1rem;background:rgba(255,255,255,0.08);color:#fff;outline:none;transition:border 0.2s;">
        <button id="jump-btn" class="slider-btn" style="margin:0 10px;height:36px;width:60px;border-radius:8px;font-size:1rem;background:#4fc3f7;color:#fff;">è·³è½¬</button>
    `;

                        const controls = document.querySelector('.slider-controls');
                        controls.innerHTML = `
        <button class="slider-btn" id="prev-btn">
            <i class="fas fa-chevron-left"></i>
        </button>
        ${pageJumpHTML}
        <button class="slider-btn" id="next-btn">
            <i class="fas fa-chevron-right"></i>
        </button>
    `;

                        document.getElementById('prev-btn').onclick = function () {
                            goToSlide(currentSlide - 1);
                        };
                        document.getElementById('next-btn').onclick = function () {
                            goToSlide(currentSlide + 1);
                        };
                        document.getElementById('jump-btn').onclick = function () {
                            const val = parseInt(document.getElementById('page-input').value, 10);
                            if (val >= 1 && val <= totalSlides) {
                                goToSlide(val - 1);
                            }
                        };
                        document.getElementById('page-input').onkeydown = function (e) {
                            if (e.key === 'Enter') {
                                document.getElementById('jump-btn').click();
                            }
                        };

                        goToSlide(0);
                        document.getElementById('history-container').style.display = 'flex';
                    }

                    function goToSlide(index) {
                        if (index < 0 || index >= totalSlides) return;

                        currentSlide = index;
                        const slidesContainer = document.getElementById('history-slides');
                        slidesContainer.style.transform = `translateX(-${currentSlide * 100}%)`;

                        document.getElementById('prev-btn').disabled = currentSlide === 0;
                        document.getElementById('next-btn').disabled = currentSlide === totalSlides - 1;

                        const input = document.getElementById('page-input');
                        if (input) input.value = currentSlide + 1;

                        const allHeaders = document.querySelectorAll('.group-header .group-title');
                        allHeaders.forEach((el, idx) => {
                            el.innerHTML = `ç¬¬ ${idx + 1} é¡µ / å…± ${totalSlides} é¡µ`;
                        });
                    }

                    // åˆå§‹åŒ–å†å²è®°å½•åŠŸèƒ½
                    document.getElementById('history-btn').addEventListener('click', showHistory);
                    document.getElementById('close-btn').addEventListener('click', function () {
                        document.getElementById('history-container').style.display = 'none';
                        goToSlide(0);
                    });

                    document.getElementById('prev-btn').addEventListener('click', function () {
                        goToSlide(currentSlide - 1);
                    });

                    document.getElementById('next-btn').addEventListener('click', function () {
                        goToSlide(currentSlide + 1);
                    });

                    document.getElementById('history-container').addEventListener('click', function (e) {
                        if (e.target === this) {
                            this.style.display = 'none';
                            goToSlide(0);
                        }
                    });

                    // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
                    document.addEventListener('DOMContentLoaded', function () {
                        const hitokotoElement = document.querySelector('.motivation-text');

                        const observer = new IntersectionObserver((entries) => {
                            entries.forEach(entry => {
                                isHitokotoVisible = entry.isIntersecting;

                                if (isHitokotoVisible) {
                                    if (!hitokotoInterval) {
                                        updateHitokoto();
                                        hitokotoInterval = setInterval(updateHitokoto, 20000);
                                    }
                                } else {
                                    clearInterval(hitokotoInterval);
                                    hitokotoInterval = null;
                                }
                            });
                        }, {
                            threshold: 0.1
                        });

                        if (hitokotoElement) {
                            observer.observe(hitokotoElement);
                        }

                        // åˆå§‹åŒ–ä¸€è¨€
                        updateHitokoto();
                        hitokotoInterval = setInterval(updateHitokoto, 20000);

                        // é¡µé¢å¸è½½æ—¶æ¸…é™¤å®šæ—¶å™¨
                        window.addEventListener('unload', () => {
                            clearInterval(hitokotoInterval);
                        });

                        document.addEventListener('visibilitychange', function () {
                            if (document.hidden) {
                                clearInterval(hitokotoInterval);
                            } else {
                                hitokotoInterval = setInterval(updateHitokoto, 20000);
                            }
                        });
                    });

                    // åˆå§‹æ›´æ–°
                    updateCountdown();
                    updateUPDisplay();
                    generateScrollingNames();
                    updatePityDisplay();
                    updateLotteryBtnText();
                </script>
</body>

</html>